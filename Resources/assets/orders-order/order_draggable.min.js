var containers=document.querySelectorAll(".draggable-zone");function getToken(url,ctx){return new Promise((resolve,reject)=>{fetch(url,{method:"POST",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(ctx)}).then(res=>{if(!res.ok){throw new Error(`Unexpected status code ${res.status}`)}return res.json()}).then(data=>{resolve(data.token)}).catch(err=>{reject(err)})})}executeFunc(function P8X1I2diQ4(){if(typeof Droppable!=="object"){return false}var droppable=new Droppable.default(containers,{draggable:".draggable",dropzone:".draggable-zone",handle:".draggable .draggable-handle",mirror:{appendTo:"body",constrainDimensions:true}});let droppableOrigin;let droppableLevel;let droppableRestrict;let toDroppable;droppable.on("drag:start",e=>{document.body.style.overflow="hidden"});droppable.on("drag:over",e=>{});droppable.on("drag:stop",async e=>{containers.forEach(c=>{c.classList.remove("draggable-dropzone--occupied")});document.body.style.overflow="auto";let level=e.sourceContainer.getAttribute("data-status");let id=e.originalSource.id;if(e.sourceContainer.getAttribute("data-status")!==droppableLevel&&droppableRestrict!=="restricted"){const modal=document.getElementById("modal");modal.innerHTML='<div class="modal-dialog modal-dialog-centered"><div class="d-flex justify-content-center w-100"><div class="spinner-border text-light" role="status"><span class="visually-hidden">Loading...</span></div></div></div>';bootstrap.Modal.getOrCreateInstance(modal).show();fetch("/admin/order/"+droppableLevel+"/"+id,{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(function(response){if(response.status===302||response.status===404){bootstrap.Modal.getOrCreateInstance(modal).hide();return true}if(response.status===200){return response.text()}let $dangerOrderToast='{ "type":"danger" , '+'"header":"Ошибка при изменении"  , '+'"message" : "Ошибка при изменении статуса заказа!" }';createToast(JSON.parse($dangerOrderToast));bootstrap.Modal.getOrCreateInstance(modal).hide();return false}).then(function(html){if(html===true){submitLink("/admin/order/status/"+droppableLevel+"/"+id);bootstrap.Modal.getOrCreateInstance(modal).hide();return}if(html){const modal=document.getElementById("modal");modal.innerHTML=html;let lazy=document.createElement("script");lazy.src="/assets/js/lazyload.min.js?v={{ version }}";document.head.appendChild(lazy);modal.querySelectorAll("form").forEach(function(forms){forms.addEventListener("submit",function(event){event.preventDefault();submitModalForm(forms);return false})})}}).catch(function(err){console.warn("Something went wrong.",err)});console.log(level+" => "+droppableLevel)}});droppable.on("droppable:dropped",e=>{toDroppable=e.dropzone;droppableLevel=e.dropzone.getAttribute("data-status");droppableRestrict=e.dropzone.getAttribute("data-level");if(droppableRestrict==="restricted"){e.cancel()}});return true});