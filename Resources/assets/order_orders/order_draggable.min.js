var containers=document.querySelectorAll(".draggable-zone");function getToken(url,ctx){return new Promise((resolve,reject)=>{fetch(url,{method:"POST",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(ctx)}).then(res=>{if(!res.ok){throw new Error(`Unexpected status code ${res.status}`)}return res.json()}).then(data=>{resolve(data.token)}).catch(err=>{reject(err)})})}setTimeout(function P8X1I2diQ4(){if(typeof Droppable==="object"){var droppable=new Droppable.default(containers,{draggable:".draggable",dropzone:".draggable-zone",handle:".draggable .draggable-handle",mirror:{appendTo:"body",constrainDimensions:true}});let droppableOrigin;let droppableLevel;let droppableRestrict;let toDroppable;droppable.on("drag:start",e=>{document.body.style.overflow="hidden"});droppable.on("drag:over",e=>{});droppable.on("drag:stop",async e=>{containers.forEach(c=>{c.classList.remove("draggable-dropzone--occupied")});document.body.style.overflow="auto";let level=e.sourceContainer.getAttribute("data-status");let id=e.originalSource.id;if(e.sourceContainer.getAttribute("data-status")!==droppableLevel&&droppableRestrict!=="restricted"){fetch("/admin/order/"+droppableLevel+"/"+id,{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(function(response){return response.status===200?response.text():false}).then(function(html){if(html){const modal=document.getElementById("modal");document.getElementById("modal").innerHTML=html;new bootstrap.Modal(modal).show();modal.addEventListener("shown.bs.modal",function(event){let lazy=document.createElement("script");lazy.src="/assets/js/lazyload.min.js?v={{ version }}";document.head.appendChild(lazy)});modal.querySelectorAll("form").forEach(function(forms){forms.addEventListener("submit",function(event){event.preventDefault();submitModalForm(forms);return false})});return}submitLink("/admin/order/status/"+droppableLevel+"/"+id)}).catch(function(err){console.warn("Something went wrong.",err)});console.log(level+" => "+droppableLevel)}});droppable.on("droppable:dropped",e=>{toDroppable=e.dropzone;droppableLevel=e.dropzone.getAttribute("data-status");droppableRestrict=e.dropzone.getAttribute("data-level");if(droppableRestrict==="restricted"){e.cancel()}});return}setTimeout(P8X1I2diQ4,100)},100);